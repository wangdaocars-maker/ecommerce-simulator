// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
}

// 用户表
model User {
  id        Int       @id @default(autoincrement())
  username  String    @unique
  password  String    // bcrypt 加密
  name      String?   // 真实姓名
  email     String?
  role      String    @default("student") // student/teacher/admin

  // 关联
  products  Product[]

  // 时间
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

// 商品表
model Product {
  id              Int       @id @default(autoincrement())
  title           String    // 商品标题

  // 所属用户
  userId          Int
  user            User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  // 类目
  categoryId      Int?
  category        Category? @relation(fields: [categoryId], references: [id])

  // 基本信息
  brand           String?   // 品牌
  model           String?   // 型号
  keywords        String?   // 关键词

  // 价格库存
  price           Float     // 价格
  comparePrice    Float?    // 划线价
  stock           Int       // 库存
  sku             String?   // SKU

  // 详细描述
  shortDesc       String?   // 简短描述
  description     String    // 详细描述（富文本）

  // 图片 (JSON 数组)
  images          String    @default("[]") // JSON 字符串
  mainImage       String?   // 主图 URL

  // 物流
  weight          Float?    // 重量（kg）
  packageSize     String?   // 包装尺寸 JSON: {length, width, height} (cm)
  shippingTemplate Int?     // 运费模板 ID

  // 状态
  status          String    @default("draft") // draft/published/offline

  // 时间
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@index([userId])
  @@index([status])
}

// 类目表
model Category {
  id        Int       @id @default(autoincrement())
  name      String
  parentId  Int?      // 父类目 ID
  level     Int       @default(1) // 1/2/3 级类目
  products  Product[]
  createdAt DateTime  @default(now())
}
